%!TEX root = 3_FormalAbstraction inLTLUnderUncertainty.tex

Motivated by space exploration applications we consider an autonomous rover tasked with identifying and collecting scientific samples.


\textbf{Rover model.} Without loss of generality, we consider a simple rover model as a point mass affected by stochastic disturbances on the state transitions. We assume that the position of the rover cannot be measured exactly. 
We model its dynamics as
\begin{align}
	x_{k+1}&=\begin{bmatrix}
		1&0\\
		0&1
	\end{bmatrix} x_{k} + \begin{bmatrix}
		1&0\\
		0&1
	\end{bmatrix} u_k+ w_k\\
z_k&=\begin{bmatrix}
		1&0\\
		0&1
	\end{bmatrix}x_k+v_k
\end{align}
with $w_k\sim \CA N \left(0,\begin{bmatrix}.4&-.2\\-.2&.4\end{bmatrix}\right)$ and $v_k\sim \CA N \left(0,\begin{bmatrix}1&.1\\.1&1\end{bmatrix}\right)$

A finite abstraction $M_{syst}$ of this model is constructed as outlined in the previous section by discretizing the input space $[-1,1]^2$ with nine discrete inputs, and the state space $[-10, 10]^2$ with grid points separated by $(0.76481, 0.64426)$.

\begin{figure}
	\input{figs/epsdel}
	\caption{Trade-off between $\epsilon$ and $\delta$.  }
\end{figure}

\textbf{Environment model.} We consider exploration in a partially unknown environment. In particular, there are two potential target regions $T_1$ and $T_2$ where the probability of encountering a sample has been assessed as 0.5 and 0.6, respectively. In addition, there are two potential obstacle regions $O_1$ and $O_2$ where estimates based on satellite imagery give probabilities 0.1 and 0.3 that the rover can not traverse the obstacle safely. For both target and obstacle regions, we assume that the true nature of the region can be measured when the rover is within a certain distance of the regions. The regions are illustrated in Figs. \ref{fig:exp1} and \ref{fig:exp2}.

This environment model can be modeled as a finite-state MDP $M_{env}$. Furthermore, we model a failure probability of 0.01 at each step with an additional MDP $M_{fail}$.

\textbf{Specification.} The objective is to collect a sample while avoiding unsafe regions. To this end, we consider the specification
\begin{equation}
	\varphi = \lozenge \texttt{sample} \land \left( \lnot \texttt{fail} \; \mathcal {U} \; \texttt{sample} \right),
\end{equation}
where the atomic proposition \texttt{sample} is true if the rover is in a target region that contains a sample, and the atomic proposition \texttt{fail} is defined as being in an obstacle region that contains an obstacle, or that the system is in failure mode.

\textbf{Results.} We consider the aggregate system $M_{syst} \times M_{env} \times M_{fail}$ which is an MDP with 9 inputs and 277182 states. The specification $\varphi$ can be converted into a deterministic finite automaton. Via \eqref{eq:prob:robust_optimal} we can synthesize a control policy. Figs. \ref{fig:exp1} and \ref{fig:exp2} depict trajectories generated by the control policies, and the estimated probability that the specification can be satisfied, under two different resolutions of the unknown environment. In both experiments only $T_2$ contains a sample, and $O_1$ contains an obstacle. The difference is that in Fig. \ref{fig:exp1} also $O_2$ contains an obstacle but in Fig. \ref{fig:exp2} this region can be safely transversed.

\begin{figure}
	\footnotesize
	\setlength\figurewidth{\columnwidth} 
	\setlength\figureheight{0.6\columnwidth} 

	\input{figs/exp1-map.tikz}
	\setlength\figureheight{0.4\columnwidth} 

	\input{figs/exp1-prob.tikz}
	\caption{Above: six trajectories starting at different initial conditions. Below: estimated probability to satisfy the specification over time for the same trajectories. No sample is found in $T_1$, and $O_2$ can be safely transversed. Jumps occur in the probabilities when (non-)existence of samples are measured when the rover is close to the regions.}
	\label{fig:exp1}
\end{figure}

\begin{figure}
	\footnotesize
	\setlength\figurewidth{\columnwidth} 
	\setlength\figureheight{0.6\columnwidth} 

	\input{figs/exp2-map.tikz}

	\setlength\figureheight{0.4\columnwidth} 

	\input{figs/exp2-prob.tikz}
	\caption{Same as Fig. \ref{fig:exp1} with the difference that both $O_1$ and $O_2$ contain obstacles.}
	\label{fig:exp2}
\end{figure}